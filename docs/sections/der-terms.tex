\section{Derivation terms}

Derivation trees are key mathematical entities when studying the proof theory of
a logic, but are not very convenient as data structures to be manipulated by
machines, particularly as they often contain redundant information. For this
reason, we give below a definition of \emph{derivation terms}, which in our
setting are just syntactic objects describing a derivation of a forward sequent
in the forward calculus. In their definition, we must of course ensure to always
be able to restore all details of a derivation from the term alone.

\begin{figure}[h]
  \begin{mdframed}
    \[
      \begin{prooftree}
        \justifies
        \seqpt{\dtinit{p}}{\zsyseq{\Gamma}{p}{\emptyctrl{}}{p}}
      \end{prooftree}
      \qquad\qquad
      \begin{prooftree}
        \seqpt{\mathcal{D}}{
          \zsyseq{\Gamma, A}{\Delta, A}{\reactlist{}}{C}}
        \justifies
        \seqpt{\dtcopy{\mathcal{D}}{A}}{
          \zsyseq{\Gamma, A}{\Delta}{\reactlist{}}{C}}
      \end{prooftree}
    \]

    \[
      \begin{prooftree}
        \seqpt{\mathcal{D}}{\zsyseq{\Gamma}{\Delta}{\emptyctrl{}}{A}}
        \qquad
        \seqpt{\mathcal{D'}}{\zsyseq{\Gamma}{\Delta'}{\emptyctrl{}}{B}}
        \justifies
        \seqpt{
          \dtotimesr{\mathcal{D}}{\mathcal{D'}}
        }{
          \zsyseq{\Gamma}{\Delta, \Delta'}{\emptyctrl{}}{A \otimes B}
        }
      \end{prooftree}
    \]

    \[
      \begin{prooftree}
        \seqpt{
          \mathcal{D}
        }{
          \zsyseq{\Gamma}{\Delta, A, B}{\reactlist{}}{C}
        }
        \justifies
        \seqpt{
          \dtotimesl{\mathcal{D}}{A}{B}
        }{
          \zsyseq{\Gamma}{\Delta, A \otimes B}{\reactlist{}}{C}
        }
      \end{prooftree}
      \qquad
      \begin{prooftree}
        \seqpt{\mathcal{D}}{\zsyseq{\Gamma}{\Delta, A}{\reactlist{}}{B}}
        \justifies
        \seqpt{
          \dtlimpr{\mathcal{D}}{A}
        }{
          \zsyseq{\Gamma}{\Delta}{\emptyctrl{}}{
            A \rightarrow_{\reactlist{}}^{\elembases{\Delta}} B}
        }
      \end{prooftree}
    \]

    \[
      \begin{prooftree}
        \seqpt{\mathcal{D}}{\zsyseq{\Gamma}{\Delta}{\emptyctrl{}}{A}}
        \qquad
        \seqpt{\mathcal{D'}}{\zsyseq{\Gamma}{\Delta', B}{\reactlist{}'}{C}}
        \justifies
        \seqpt{
          \dtlimpl{\mathcal{D}}{\mathcal{D'}}{B}{\reactlist{}}{S}
        }{
          \zsyseq{\Gamma}{\Delta, \Delta',
            A \rightarrow_{\reactlist{}}^S B}{
            \baseandplus{\Delta'}{\reactlist{}}{\reactlist{}'}
          }{C}
        }
      \end{prooftree}
    \]
  \end{mdframed}
  \caption{Backward calculus with derivation terms}
  \label{fig:bkwdderterm}
\end{figure}

The backward calculus given in Figure~\ref{fig:bkwdderterm} serves as a full
inductive definition of the derivation terms. However, derivations (in
particular, during automated proof search) are going to be performed in the
forward derived rule calculus in Figure~\ref{fig:fwdderrulecalculus}. We
therefore need a way to extract a backward derivation term from a derivation of
the forward derived rule calculus. This is no difficult task, as one would
expect.

For this purpose, we now extend the relations and rules of the forward derived
rule calculus to produce derivation terms for the calculus in
Figure~\ref{fig:bkwdderterm} along the usual presequents.

\begin{figure}[h]
  \begin{mdframed}
    \[
      \begin{prooftree}
        \justifies
        \relj{\frfrel{p}}{\cdot}{\seqpt{\dtinit{p}}{\zfneuseqempty{\cdot}{p}}}
        \using{\init}
      \end{prooftree}
    \]

    \[
      \begin{prooftree}
        \justifies
        \relj{\frfrel{R}}{
          \seqpt{\mathcal{D}}{\zfneuseq{\Gamma}{\Delta}{\emptyctrl{}}{R}}
        }{\seqpt{\mathcal{D}}{\zfneuseqempty{\Gamma}{\Delta}}}
        \using{\faplus}
      \end{prooftree}
    \]

    \[
      \begin{prooftree}
        \relj{\frfrel{A}}{\Sigma_1}{
          \seqpt{\mathcal{D}}{\zfneuseqempty{\Gamma_1}{\Delta_1}}}
        \qquad
        \relj{\frfrel{B}}{\Sigma_2}{
          \seqpt{\mathcal{D}'}{\zfneuseqempty{\Gamma_2}{\Delta_2}}
        }
        \justifies
        \relj{\frfrel{A \otimes B}}{\Sigma_1 \cdot \Sigma_2}{
          \seqpt{\dtotimesr{\mathcal{D}}{\mathcal{D}'}}{\zfneuseqempty{\Gamma_1,
            \Gamma_2}{\Delta_1, \Delta_2}}}
        \using{\otimes F}
      \end{prooftree}
    \]

    \[
      \begin{prooftree}
        \relj{\factrel{
            \zsyseq{\Delta}{\Omega, A, B}{\zeta}{\xi}}
        }{\Sigma}{\seqpt{\mathcal{D}}{s}}
        \justifies
        \relj{\factrel{
            \zsyseq{\Delta}{\Omega, A \otimes B}{\zeta}{\xi}}
        }{\Sigma}{\seqpt{\dtotimesl{\mathcal{D}}{A}{B}}{s}}
        \using{\otimes A}
      \end{prooftree}
    \]

    \[
      \begin{prooftree}
        \relj{\factrel{\zsyseq{\Delta, P}{\Omega}{\zeta}{\xi}}}{\Sigma}{
          \seqpt{\mathcal{D}}{s}}
        \justifies
        \relj{\factrel{\zsyseq{\Delta}{\Omega, P}{\zeta}{\xi}}}{\Sigma}{
          \seqpt{\mathcal{D}}{s}}
        \using{\actrule}
      \end{prooftree}
    \]

    \[
      \begin{prooftree}
        \justifies
        \relj{
          \factrel{\zsyseq{\Delta}{\cdot}{\cdot}{\cdot}}
        }{
          \seqpt{\mathcal{D}}{\zfneuseq{\Gamma}{\Delta, \Delta'}{\reactlist{}}{C}}
        }{
          \seqpt{\mathcal{D}}{\zfneuseq{\Gamma}{\Delta'}{\reactlist{}}{C}}
        }
        \using{\matchrule}
      \end{prooftree}
    \]

    \[
      \begin{prooftree}
        \justifies
        \relj{
          \factrel{\zsyseq{\Delta}{\cdot}{\reactlist{}}{C}}
        }{
          \seqpt{\mathcal{D}}{\zfneuseq{\Gamma}{\Delta, \Delta'}{\reactlist{}}{C}}
        }{
          \seqpt{\mathcal{D}}{\zfneuseqempty{\Gamma}{\Delta'}}
        }
        \using{\matchprimerule}
      \end{prooftree}
    \]
  \end{mdframed}
  \caption{Forward focused derived rule calculus with derivation terms}
  \label{fig:fwdderrulecalculusderterms}
\end{figure}

\begin{figure}[h]
  \begin{mdframed}
    \[
      \begin{prooftree}
        s_1 \quad \dots \quad s_n \quad
        (\relj{\frfrel{Q}}{s_1 \dots s_n}{
          \seqpt{\mathcal{D}}{\fneuseq{\Gamma}{\Delta}{\cdot}}
        })
        \justifies
        \seqpt{\mathcal{D}}{\zfneuseq{\Gamma}{\Delta}{\emptyctrl{}}{Q}}
        \using{\focplusrule}
      \end{prooftree}
    \]

    \[
      \begin{prooftree}
        \[
          \relj{\frfrel{A}}{s_1, \dots, s_n}{
            \seqpt{\mathcal{D}}{\zfneuseqempty{\Gamma_1}{\Delta_1}}
          }
          \proofdotseparation=1.2ex
          \proofdotnumber=0
          \leadsto
          \relj{\factrel{
              \zsyseq{\cdot}{B}{\cdot}{\cdot}}
          }{s}{
            \seqpt{\mathcal{D}'}{\zfneuseq{\Gamma_2}{\Delta_2}{\reactlist{}'}{C}}
          }
        \]
        \quad
        \[
          \resplist{\Delta_2}{\reactlist{}}
          \proofdotseparation=1.2ex
          \proofdotnumber=0
          \leadsto
          s_1 \quad \dots \quad s_n \quad s
        \]
        \justifies
        \seqpt{\dtlimpl{\mathcal{D}}{\mathcal{D}'}{B}{\reactlist{}}{S}}{
          \zfneuseq{\Gamma_1, \Gamma_2}{\Delta_1, \Delta_2,
            A \rightarrow_{\reactlist{}}^S B}{
            \baseandplus{\Delta_2}{\reactlist{}}{\reactlist{}'}
          }{C}}
        \using{\rightarrow L}
      \end{prooftree}
    \]

    \[
      \begin{prooftree}
        \[
          \relj{\frfrel{A}}{s_1, \dots, s_n}{
            \seqpt{\mathcal{D}}{\zfneuseqempty{\Gamma_1}{\Delta_1}}}
          \proofdotseparation=1.2ex
          \proofdotnumber=0
          \leadsto
          \relj{\factrel{
              \zsyseq{\cdot}{B}{\cdot}{\cdot}}
          }{s}{
            \seqpt{\mathcal{D}'}{\zfneuseq{\Gamma_2}{\Delta_2}{\reactlist{}'}{C}}}
        \]
        \quad
        \[
          \resplist{\Delta_2}{\reactlist{}}
          \proofdotseparation=1.2ex
          \proofdotnumber=0
          \leadsto
          s_1 \quad \dots \quad s_n \quad s
        \]
        \justifies
        \seqpt{\dtcopy{\dtlimpl{\mathcal{D}}{\mathcal{D}'}{B}{\reactlist{}}{\emptyset}}{
          A \rightarrow_{\reactlist{}}^{\emptyset} B}}
        {\zfneuseq{\Gamma_1, \Gamma_2, A \rightarrow_{\reactlist{}}^{\emptyset} B
        }{\Delta_1, \Delta_2,
        }{
          \baseandplus{\Delta_2}{\reactlist{}}{\reactlist{}'}
        }{C}}
        \using{\copyrule}
      \end{prooftree}
    \]

    \[
      \begin{prooftree}
        s \qquad
        \relj{\factrel{\zsyseq{\cdot}{A}{\reactlist{}}{B}}}{s}{
          \seqpt{\mathcal{D}}{\zfneuseqempty{\Gamma}{\Delta}}}
        \justifies
        \seqpt{\dtlimpr{\mathcal{D}}{A}}{\zfneuseq{\Gamma}{\Delta}{\emptyctrl{}}{A
          \rightarrow_{\reactlist{}}^{\elembases{\Delta}} B}}
        \using{\rightarrow R}
      \end{prooftree}
    \]
  \end{mdframed}
  \caption{Forward focused derived rule calculus with derivation terms}
  \label{fig:fwdderrulecalculusderterms}
\end{figure}



%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../docs"
%%% End:
