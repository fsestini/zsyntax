\begin{theorem}
  \begin{enumerate}
  \item If $\zqseqct{\Gamma}{\nabla}{\Delta}{\Omega}{1}{A}$, then
    \begin{enumerate}
    \item If $\zqseqct{\Gamma}{\nabla'}{\Delta'}{\Omega', A}{2}{C}$ and
      $\respects{\Omega', \Delta', \nabla'}{\ctrlset{1}}$, then

      $\zqseq{\Gamma}{\nabla, \nabla'}{\Delta, \Delta'}{\Omega, \Omega'}{
        \ctrlset{1} \cup \ctrlset{2}}{C}$.
    \item If $\zqseqct{\Gamma}{\nabla'}{\Delta', A}{\Omega'}{2}{C}$ and
      $\respects{\Omega', \Delta', \nabla'}{\ctrlset{1}}$, then

      $\zqseq{\Gamma}{\nabla,\nabla'}{\Delta, \Delta'}{\Omega, \Omega'}{
        \ctrlset{1} \cup \ctrlset{2}}{C}$;

    \item If $\zqseq{\Gamma}{\nabla', A}{\Delta'}{\Omega'}{\ctrlset{2}}{C}$, then

      $\zqseq{\Gamma}{\nabla,\nabla'}{\Delta, \Delta'}{\Omega, \Omega'}{
        \ctrlset{1} \cup \ctrlset{2}}{C}$;

    \end{enumerate}

  \item If $\zfocseq{\Gamma}{\nabla}{A}$, then
    \begin{enumerate}
    \item If $\zqseq{\Gamma}{\nabla'}{\Delta'}{\Omega', A}{\ctrlset{}}{C}$, then
      $\zqseq{\Gamma}{\nabla, \nabla'}{\Delta'}{\Omega'}{\ctrlset{}}{C}$.
    \item If $\zqseq{\Gamma}{\nabla'}{\Delta', A}{\Omega'}{\ctrlset{}}{C}$, then
      $\zqseq{\Gamma}{\nabla, \nabla'}{\Delta'}{\Omega'}{\ctrlset{}}{C}$.
    \item If $\zqseq{\Gamma}{\nabla', A}{\Delta'}{\Omega'}{\ctrlset{}}{C}$, then
      $\zqseq{\Gamma}{\nabla, \nabla'}{\Delta'}{\Omega'}{\ctrlset{}}{C}$.
    \end{enumerate}


  \end{enumerate}
\end{theorem}
\begin{proof}

  The proof proceeds by simultaneous double induction on all six cuts, either on
  the height of the derivation or on the size of cut formula. Again, we use the
  proof in [cmu paper] as a model.

  \paragraph{Cut 1a}

  \begin{enumerate}
  \item Case $\otimes L$, lact1, lact2 on the left premise are treated as left
    commutative cases similarly to [proof of cut for backward calculus].

  \item Left focus.

    \[
      \begin{prooftree}
        \[
          \zfocseq{\Gamma}{\nabla}{A}
          \quad
          A\ \text{focusable}
          \justifies
          \zqseq{\Gamma}{\nabla}{\cdot}{\cdot}{\emptyset}{A}
        \]
        \quad
        \zqseq{\Gamma}{\nabla'}{\Delta'}{\Omega', A}{\ctrlset{}}{C}
        \justifies
        \zqseq{\Gamma}{\nabla, \nabla'}{\Delta, \Delta'}{\Omega'}{\ctrlset{}}{C}
      \end{prooftree}
    \]

    then, the thesis follows by induction hypothesis and cut 2a.

  \item $\otimes L$, right commutative.

    \[
      \begin{prooftree}
        \ztriseq{\Gamma}{\Delta}{\Omega}{\ctrlset{}}{A}
        \quad
        \[
          \ztriseq{\Gamma}{\Delta'}{\Omega', C, D, A}{\ctrlset{}'}{C}
          \justifies
          \ztriseq{\Gamma}{\Delta'}{\Omega', C \otimes D, A}{\ctrlset{}'}{C}
        \]
        \justifies
        \ztriseq{\Gamma}{\Delta, \Delta'}{\Omega, \Omega', C \otimes D}{\ctrlset{} \cup
          \ctrlset{}'}{C}
        \using{\respects{\Omega', \Delta', C \otimes D}{\ctrlset{}}}
      \end{prooftree}
    \]

    then, by inductive hypothesis and remembering that
    $\respects{\Omega', \Delta', C \otimes D}{\ctrlset{}}$ implies
    $\respects{\Omega', \Delta', C, D}{\ctrlset{}}$, we have

    \[
      \begin{prooftree}
        \[
          \ztriseq{\Gamma}{\Delta}{\Omega}{\ctrlset{}}{A}
          \quad
          \ztriseq{\Gamma}{\Delta'}{\Omega', C, D, A}{\ctrlset{}'}{C}
          \justifies
          \ztriseq{\Gamma}{\Delta, \Delta'}{\Omega, \Omega', C, D}{\ctrlset{} \cup
            \ctrlset{}'}{C}
          \using{\respects{\Omega', \Delta', C, D}{\ctrlset{}}}
        \]
        \justifies
        \ztriseq{\Gamma}{\Delta, \Delta'}{\Omega, \Omega', C \otimes D}{\ctrlset{} \cup
          \ctrlset{}'}{C}
      \end{prooftree}
    \]

  \item Case lact1, lact2, are all easy right commutative cases.


  \item Case right premise is act1 or act2 on the cut formula. Then the thesis
    follows by cut 1b or 1c.

  \end{enumerate}

  \paragraph{Cut 1b}

  If $\Omega$ in the second premise is non-empty, we treat the cut as an usual
  right-commutative case, similarly to [cut proof backw calculus]. Otherwise, we
  can assume it to be empty.

  \begin{enumerate}
  \item Case $\otimes L$, act1, act2 in the left premise are all straightforward
    left commutative cases, as before.

  \item Left focus.

    \[
      \begin{prooftree}
        \[
          \zfocseq{\Gamma}{\Delta}{A}
          \quad
          A\ \text{focusable}
          \justifies
          \ztriseq{\Gamma}{\Delta}{\cdot}{\emptyset}{A}
        \]
        \quad
        \ztriseq{\Gamma}{\Delta', A}{\Omega'}{\ctrlset{}}{C}
        \justifies
        \ztriseq{\Gamma}{\Delta, \Delta'}{\Omega, \Omega'}{\ctrlset{}}{C}
      \end{prooftree}
    \]

    then, the thesis follows by induction hypothesis and cut 2b.

  \item Case $\rightarrow L$, left commutative.

    \[
      \begin{prooftree}
        \[
          \zfocseq{\Gamma}{\nabla_1}{C}
          \qquad
          \zqseq{\Gamma}{\nabla_2}{\Delta_1}{D}{\ctrlset{1}}{A}
          \justifies
          \zqseq{\Gamma}{\nabla_1, \nabla_2}{\Delta_1, C \rightarrow_{\ctrlset{}}^S
            D}{\cdot}{\ctrlset{} \cup \ctrlset{1}}{A}
        \]
        \quad
        \zqseq{\Gamma}{\nabla_3}{\Delta_2, A}{\cdot}{\ctrlset{2}}{E}
        \justifies
        \zqseq{\Gamma}{\nabla_1, \nabla_2, \nabla_3}{\Delta_1, \Delta_2,
          C \rightarrow_{\ctrlset{}}^S
          D}{\cdot}{\ctrlset{} \cup
          \ctrlset{1} \cup \ctrlset{2}}{E}
        \using{\respects{\nabla_3, \Delta_2}{\ctrlset{} \cup \ctrlset{1}}}
      \end{prooftree}
    \]

    then, by inductive hypothesis

    \[
      \begin{prooftree}
        \zfocseq{\Gamma}{\nabla_1}{C}
        \quad
        \[
          \zqseq{\Gamma}{\nabla_2}{\Delta_1}{D}{\ctrlset{1}}{A}
          \qquad
          \zqseq{\Gamma}{\nabla_3}{\Delta_2, A}{\cdot}{\ctrlset{2}}{E}
          \justifies
          \zqseq{\Gamma}{\nabla_2, \nabla_3}{\Delta_1, \Delta_2}{D}{\ctrlset{1}\cup\ctrlset{2}}{E}
          \using{\respects{\nabla_3, \Delta_2}{\ctrlset{1}}}
        \]
        \justifies
        \zqseq{\Gamma}{\nabla_1, \nabla_2, \nabla_3}{\Delta_1, \Delta_2,
          C \rightarrow_{\ctrlset{}}^S
          D}{\cdot}{\ctrlset{} \cup
          \ctrlset{1} \cup \ctrlset{2}}{E}
        \using{\respects{\nabla_2, \nabla_3, \Delta_1, \Delta_2}{\ctrlset{}}}
      \end{prooftree}
    \]

  \item Case $\copyrule$, left commutative. Same as $\rightarrow L$.

  \item Case principal cut with $\rightarrow$.

    \[
      \begin{prooftree}
        \[
          \zqseq{\Gamma}{\nabla}{\Delta}{A}{\ctrlset{}}{B}
          \justifies
          \zqseq{\Gamma}{\nabla}{\Delta}{\cdot}{\emptyset}
          {A \rightarrow_{\ctrlset{}}^{\elembases{\nabla, \Delta}} B}
        \]
        \quad
        \[
          \zfocseq{\Gamma}{\nabla'}{A}
          \qquad
          \zqseq{\Gamma}{\nabla''}{\Delta'}{B}{\ctrlset{}'}{C}
          \justifies
          \zqseq{\Gamma}{\nabla', \nabla''}{\Delta', A
            \rightarrow_{\ctrlset{}}^{\elembases{\nabla, \Delta}} B}{\cdot}{\ctrlset{}
            \cup \ctrlset{}'}{C}
          \using{\respects{\nabla'', \Delta'}{\ctrlset{}}}
        \]
        \justifies
        \zqseq{\Gamma}{\nabla, \nabla', \nabla''}{\Delta, \Delta'}{\cdot}{\ctrlset{} \cup
          \ctrlset{}'}{C}
      \end{prooftree}
    \]

    Then, by inductive hypothesis, cut 2a, and cut 1a we get

    \[
      \begin{prooftree}
        \[
          \zfocseq{\Gamma}{\nabla'}{A}
          \qquad
          \zqseq{\Gamma}{\nabla}{\Delta}{A}{\ctrlset{}}{B}
          \justifies
          \zqseq{\Gamma}{\nabla, \nabla'}{\Delta}{\cdot}{\ctrlset{}}{B}
        \]
        \quad
        \zqseq{\Gamma}{\nabla''}{\Delta'}{B}{\ctrlset{}'}{C}
        \justifies
        \zqseq{\Gamma}{\nabla, \nabla', \nabla''}{\Delta, \Delta'}{\cdot}{\ctrlset{} \cup
          \ctrlset{}'}{C}
        \using{\respects{\nabla'', \Delta'}{\ctrlset{}}}
      \end{prooftree}
    \]

  \item Case $\rightarrow L$, right commutative. If $A$ is a side formula in the first
    premise of the cut, we treat it as a left commutative case. Otherwise, $A$
    must be a conditional and the conclusion of the first premise must be
    $\rightarrow R$.

    \[
      \begin{prooftree}
        \[
          \zqseq{\Gamma}{\nabla}{\Delta}{A}{\ctrlset{}}{B}
          \justifies
          \zqseq{\Gamma}{\nabla}{\Delta}{\cdot}{\emptyset}{
            A \rightarrow_{\ctrlset{}}^{\elembases{\nabla, \Delta}} B}
        \]
        \quad
        \[
          \zfocseq{\Gamma}{\nabla'}{C}
          \qquad
          \zqseq{\Gamma}{\nabla''}{\Delta', A
            \rightarrow_{\ctrlset{}}^{\elembases{\nabla, \Delta}} B}{D}{\ctrlset{}''}{E}
          \justifies
          \zqseq{\Gamma}{\nabla', \nabla''}{\Delta',
            C \rightarrow_{\ctrlset{}'}^{S} D, A
            \rightarrow_{\ctrlset{}}^{\elembases{\nabla, \Delta}} B}{\cdot}{\ctrlset{}'
            \cup \ctrlset{}''}{E}
          \using{\respects{\nabla'', \Delta', \Delta, \nabla}{\ctrlset{}'}}
        \]
        \justifies
        \zqseq{\Gamma}{\nabla, \nabla', \nabla''}{\Delta, \Delta', C
          \rightarrow_{\ctrlset{}'}^{S} D}{\cdot}{\ctrlset{}' \cup
          \ctrlset{}''}{E}
      \end{prooftree}
    \]

    Then, by inductive hypothesis

    \[
      \begin{prooftree}
        \zfocseq{\Gamma}{\nabla'}{C}
        \quad
        \[
          \zqseq{\Gamma}{\nabla}{\Delta}{\cdot}{\emptyset}{
            A \rightarrow_{\ctrlset{}}^{\elembases{\nabla, \Delta}} B}
          \qquad
          \zqseq{\Gamma}{\nabla''}{\Delta', A
            \rightarrow_{\ctrlset{}}^{\elembases{\nabla, \Delta}} B}{D}{\ctrlset{}''}{E}
          \justifies
          \zqseq{\Gamma}{\nabla, \nabla''}{\Delta, \Delta'}{D}{\ctrlset{}''}{E}
        \]
        \justifies
        \zqseq{\Gamma}{\nabla, \nabla, \nabla''}{\Delta, \Delta', C
          \rightarrow_{\ctrlset{}'}^{S} D}{\cdot}{\ctrlset{}' \cup
          \ctrlset{}''}{E}
        \using{\respects{\nabla'', \Delta', \Delta, \nabla}{\ctrlset{}'}}
      \end{prooftree}
    \]

  \item Case $\copyrule$, right commutative is the same as $\rightarrow L$, right
    commutative.

  \item Case $\rightarrow R$. Again, if the cut formula is a side formula, we
    treat the case as left commutative. If the cut formula is active, then the
    first premise must be an instance of $\rightarrow R$.

    \[
      \begin{prooftree}
        \[
          \zqseq{\Gamma}{\nabla}{\Delta}{A}{\ctrlset{}}{B}
          \justifies
          \zqseq{\Gamma}{\nabla}{\Delta}{\cdot}{\emptyset}{
            A \rightarrow_{\ctrlset{}}^{\elembases{\nabla, \Delta}} B}
        \]
        \quad
        \[
          \zqseq{\Gamma}{\nabla'}{\Delta',
            A \rightarrow_{\ctrlset{}}^{\elembases{\nabla, \Delta}} B}{C}{\ctrlset{}'}{D}
          \justifies
          \zqseq{\Gamma}{\nabla'}{\Delta',
            A \rightarrow_{\ctrlset{}}^{\elembases{\nabla, \Delta}}
            B}{\cdot}{\emptyset}{
            C \rightarrow_{\ctrlset{}'}^{\elembases{\nabla, \nabla', \Delta, \Delta'}} D}
        \]
        \justifies
        \zqseq{\Gamma}{\nabla, \nabla'}{\Delta, \Delta'}{\cdot}{\emptyset}{
          C \rightarrow_{\ctrlset{}'}^{\elembases{\nabla, \nabla', \Delta, \Delta'}} D}
      \end{prooftree}
    \]

    Then, by inductive hypothesis

    \[
      \begin{prooftree}
        \[
          \zqseq{\Gamma}{\nabla}{\Delta}{\cdot}{\emptyset}{
            A \rightarrow_{\ctrlset{}}^{\elembases{\nabla, \Delta}} B}
          \qquad
          \zqseq{\Gamma}{\nabla'}{\Delta',
            A \rightarrow_{\ctrlset{}}^{\elembases{\nabla, \Delta}} B}{C}{\ctrlset{}'}{D}
          \justifies
          \zqseq{\Gamma}{\nabla, \nabla'}{\Delta, \Delta'}{C}{\ctrlset{}'}{D}
        \]
        \justifies
        \zqseq{\Gamma}{\nabla, \nabla'}{\Delta, \Delta'}{\cdot}{\emptyset}{
          C \rightarrow_{\ctrlset{}'}^{\elembases{\nabla, \nabla', \Delta, \Delta'}} D}
      \end{prooftree}
    \]

  \end{enumerate}

  \paragraph{Cut 1c}

  The cut formula must be atomic, so in the left premise it must either be a
  side formula or the principal formula of a focus rule. In the first case, we
  treat the cut similarly to the other left commutative cases, otherwise we
  use the inductive hypothesis and a type 2 cut.


  \paragraph{Cut 2}

  Cuts of type 2a are all treated easily as right commutative cases, using the
  inductive hypothesis and cut 2a, 2b and 2c. The only exception is when the cut
  formula is principal, hence $A \equiv C \otimes D$. But then, we have

  \[
    \begin{prooftree}
      \[
        \zfocseq{\Gamma}{\nabla_1}{C}
        \qquad
        \zfocseq{\Gamma}{\nabla_2}{D}
        \justifies
        \zfocseq{\Gamma}{\nabla_1, \nabla_2}{C \otimes D}
      \]
      \quad
      \[
        \zqseq{\Gamma}{\nabla'}{\Delta'}{\Omega', C, D}{\ctrlset{}}{E}
        \justifies
        \zqseq{\Gamma}{\nabla'}{\Delta'}{\Omega', C \otimes D}{\ctrlset{}}{E}
      \]
      \justifies
      \zqseq{\Gamma}{\nabla_1, \nabla_2, \nabla'}{\Delta'}{\Omega'}{\ctrlset{}}{E}
    \end{prooftree}
  \]

  hence, by inductive hypothesis

  \[
    \begin{prooftree}
      \zfocseq{\Gamma}{\nabla_1}{C}
      \quad
      \[
        \zfocseq{\Gamma}{\nabla_2}{D}
        \qquad
        \zqseq{\Gamma}{\nabla'}{\Delta'}{\Omega', C, D}{\ctrlset{}}{E}
        \justifies
        \zqseq{\Gamma}{\nabla_2, \nabla'}{\Delta'}{\Omega', C}{\ctrlset{}}{E}
      \]
      \justifies
      \zqseq{\Gamma}{\nabla_1, \nabla_2, \nabla'}{\Delta'}{\Omega'}{\ctrlset{}}{E}
    \end{prooftree}
  \]

  Cuts of type 2b are only possible if the cut formula is a conditional. But then,
  the left premise of the cut must have been derived with a blur, hence the thesis
  follows by cut 1b.

  Cuts of type 2c are only possible if the cut formula is atomic, hence the left
  premise is an identity. The conclusion of the cut is then just the right
  premise.

\end{proof}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../docs"
%%% End:
