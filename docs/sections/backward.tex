\section{Backward sequent calculus}

The objective of this section is to obtain a logic describing the modified
provability relation of \eznd{}, that is amenable to efficient proof search
while being sound and complete with \eznd{} itself. This basically means that we
are going to need some sort of sequent calculus enjoying properties like the
subformula property and cut admissibility.  Given the obvious similarities
between a Zsyntax proof and a proof in intuitionistic linear logic, it seems
reasonable to aim for a slightly modified version of the sequent calculus for
intuitionistic linear logic in our search for such a calculus. The rest of this
section does exactly that.

In what follows, we try to mold our sequent calculus rules into shape by
starting from what would be a direct translation of the rules of \eznd{} and
refining them into more standard form by cut. The aim is to get rules that
allow us to easily prove the subformula property and cut admissibility in a
later stage.

As premises and conclusions we have annotated sequents of the following form

\[
  \zsyseq{\Gamma}{\Delta}{\ctrlset{}}{C}
\]

where $\Gamma$ is the \emph{unrestricted context}, namely one where contraction
and weakening are accepted, $\Delta$ is the usual linear context, and
$\ctrlset{} \in \mathcal{P}(\bioformulas^*)$ is a control set. The intuitive
explanation is that a valid sequent of this form witnesses the fact that, under
the set $\Gamma$ of biological axioms available, there exists a sequence of
Zsyntax transitions that bring the aggregate $\Delta$ to the aggregate $C$,
provided any additional context that may surround $\Gamma$ does not violate the
control set $\ctrlset{}$. In other words, the validity of the sequent above
expresses that we know that $\Delta \models_{\ctrlset{}} C$ holds in \eznd{}.

Throughout the rest of the presentation, we assume that the set of axioms is
``harmless'', in the sense that $\elembases{\Gamma} = \emptyset$.
This is the same as saying that all formulas in $\Gamma$ must be conditionals
with an empty elementary base.

We now give the rules of the calculus. To do so, we will use the following form
of cut rule, even though we will not really include it in the calculus since it
will be shown to be admissible.

\[
  \begin{prooftree}
    \zsyseq{\Gamma}{\Delta_1}{\ctrlset{1}}{A}
    \qquad
    \zsyseq{\Gamma}{\Delta_2, A}{\ctrlset{2}}{B}
    \justifies
    \zsyseq{\Gamma}{\Delta_1, \Delta_2}{\ctrlset{1}\cup\ctrlset{2}}{B}
    \using{\forall \Delta, \respects{\Delta,\Delta_2}{\ctrlset{1}}}
  \end{prooftree}
\]

\paragraph{Identity}

The trivial reaction is the one that does nothing:

\[
  \begin{prooftree}
    \justifies
    \zsyseq{\Gamma}{A}{\emptyset}{A}
  \end{prooftree}
\]

It will be proved later that we can rescrict $A$ to the atomic case while
retaining completeness.

\paragraph{Biological axioms}

The calculus has a built-in way to account for (biological) axioms with the
unrestricted context. To make an axiom $A$ available to a derivation, it
sufficies to take it from the unrestricted context and add it to the linear
context. Formulas in the unrestricted context can of course be used ad libitum:

\[
  \begin{prooftree}
    \zsyseq{\Gamma, A}{\Delta, A}{\ctrlset{}}{C}
    \justifies
    \zsyseq{\Gamma, A}{\Delta}{\ctrlset{}}{C}
  \end{prooftree}
\]

\paragraph{$\otimes$ elimination}

A direct translation from Zsyntax yields a rule that is already in an acceptable
form for a left rule.

\[
  \begin{prooftree}
    \bkwseq{\Gamma}{\Delta, A, B}{C}
    \justifies
    \bkwseq{\Gamma}{\Delta, A \otimes B}{C}
  \end{prooftree}
\]

\paragraph{$\otimes$ introduction}

The $\otimes$ introduction rule of the original calculus is the exact inverse of
the elimination rule, so a direct translation from Zsyntax to sequent calculus
would be the following:

\[
  \begin{prooftree}
    \zsyseq{\Gamma}{\Delta, A \otimes B}{\ctrlset{}}{C}
    \justifies
    \zsyseq{\Gamma}{\Delta, A, B}{\ctrlset{}}{C}
  \end{prooftree}
\]

This, however, is not a good rule as it augments the complexity of the sequent,
and breaks the left-right symmetry. To get to a better result, we first notice
that the above rule and the following axiom are equivalent in the presence of
cut

\[
  \begin{prooftree}
    \justifies
    \zsyseq{\Gamma}{A,B}{\emptyset}{A \otimes B}
  \end{prooftree}
\]

The second comes from the first by identity. The first comes from the second by
cut:\footnote{ Notice that the side condition of the cut holds vacuously when,
  as in this case, the referenced control set is empty. Other side conditions of
  this form will be tacitly omitted from now on.}

\[
  \begin{prooftree}
    \[ \justifies \zsyseq{\Gamma}{A,B}{\emptyset}{A \otimes B} \]
    \qquad
    \zsyseq{\Gamma}{\Delta, A \otimes B}{\ctrlset{}}{C}
    \justifies
    \zsyseq{\Gamma}{\Delta, A, B}{\ctrlset{}}{C}
    \using{\forall \Delta, \respects{\Delta,\Delta_2}{\emptyset}}
  \end{prooftree}
\]

However, we now have to do some additional cuts on the axiom above in order to
obtain something that allows us to eliminate the cut rule later.

\[
  \begin{prooftree}
    \zsyseq{\Gamma}{\Delta_2}{\emptyset}{B} \qquad
    \[
      \zsyseq{\Gamma}{\Delta_1}{\emptyset}{A} \qquad
      \[\justifies \zsyseq{\Gamma}{A,B}{\emptyset}{A \otimes B} \]
      \justifies
      \zsyseq{\Gamma}{\Delta_1, B}{\emptyset}{A \otimes B}
    \]
    \justifies
    \zsyseq{\Gamma}{\Delta_1, \Delta_2}{\emptyset}{A \otimes B}
  \end{prooftree}
\]

thus yielding the following rule

\[
  \begin{prooftree}
    \zsyseq{\Gamma}{\Delta_1}{\emptyset}{A} \qquad
    \zsyseq{\Gamma}{\Delta_2}{\emptyset}{B}
    \justifies
    \zsyseq{\Gamma}{\Delta_1, \Delta_2}{\emptyset}{A \otimes B}
  \end{prooftree}
\]

\paragraph{$\limp$ introduction}

A direct translation to our single-succedent sequent calculus would be the
following:

\[
  \begin{prooftree}
    \zsyseq{\Gamma}{\Delta_1, A}{\ctrlset{1}}{B} \qquad
    \zsyseq{\Gamma}{\Delta_2, A \rightarrow^{\elembases{\Delta_1}}_{\ctrlset{1}}
      B}{\ctrlset{2}}{C}
    \justifies
    \zsyseq{\Gamma}{\Delta_1, \Delta_2}{\ctrlset{2}}{C}
  \end{prooftree}
\]

However, this rule again has the drawbacks of increasing the complexity of the
sequent in the bottom-up direction, and breaking the left-right symmetry. A
better rule can be obtained as a special case of the one above:

\[
  \begin{prooftree}
    \zsyseq{\Gamma}{\Delta_1, A}{\ctrlset{1}}{B}
    \qquad
    \[\justifies
      \zsyseq{\Gamma}{A \rightarrow^{\elembases{\Delta_1}}_{\ctrlset{1}}
      B}{\emptyset}{A \rightarrow^{\elembases{\Delta_1}}_{\ctrlset{1}}
      B}\]
    \justifies
    \zsyseq{\Gamma}{\Delta_1}{\emptyset}{A \rightarrow^{\elembases{\Delta_1}}_{\ctrlset{1}}
      B}
  \end{prooftree}
\]

thus yielding the following:

\[
  \begin{prooftree}
    \zsyseq{\Gamma}{\Delta, A}{\ctrlset{}}{B}
    \justifies
    \zsyseq{\Gamma}{\Delta}{\emptyset}{A \rightarrow^{\elembases{\Delta}}_{\ctrlset{}}
      B}
  \end{prooftree}
\]

The equivalence is witnessed by the fact that the first rule can be obtained
from the second by cut:

\[
  \begin{prooftree}
    \[
      \zsyseq{\Gamma}{\Delta_1, A}{\ctrlset{1}}{B}
      \justifies
      \zsyseq{\Gamma}{\Delta}{\emptyset}{A \rightarrow^{\elembases{\Delta_1}}_{\ctrlset{1}}
        B}
    \]
    \qquad
    \zsyseq{\Gamma}{\Delta_2, A \rightarrow^{\elembases{\Delta_1}}_{\ctrlset{1}}
      B}{\ctrlset{2}}{C}
    \justifies
    \zsyseq{\Gamma}{\Delta_1, \Delta_2}{\ctrlset{2}}{C}
  \end{prooftree}
\]

\paragraph{$\limp$ elimination}

The direct translation would be the following:

\[
  \begin{prooftree}
    \zsyseq{\Gamma}{\Delta, B}{\ctrlset{}'}{C}
    \justifies
    \zsyseq{\Gamma}{\Delta, A \rightarrow^{\elembases{S}}_{\ctrlset{}}
      B, A}{\ctrlset{} \cup \ctrlset{}'}{C}
    \using{\respects{\Delta}{\ctrlset{}}}
  \end{prooftree}
\]

We can get to a better left rule that only mentions the principal formula in the
conclusion with a cut:

\[
  \begin{prooftree}
    \zsyseq{\Gamma}{\Delta_1}{\emptyset}{A}\qquad
    \[
      \zsyseq{\Gamma}{\Delta_2, B}{\ctrlset{2}}{C}
      \justifies
      \zsyseq{\Gamma}{\Delta_2, A \rightarrow^{\elembases{S}}_{\ctrlset{1}}
        B, A}{\ctrlset{2}}{C}
      \using{\respects{\Delta_2}{\ctrlset{1}}}
    \]
    \justifies
    \zsyseq{\Gamma}{\Delta_1, \Delta_2, A \rightarrow^{\elembases{S}}_{\ctrlset{1}} B}{\ctrlset{1}\cup\ctrlset{2}}{C}
  \end{prooftree}
\]

thus yielding the following rule:

\[
  \begin{prooftree}
    \zsyseq{\Gamma}{\Delta_1}{\emptyset}{A}\qquad
    \zsyseq{\Gamma}{\Delta_2, B}{\ctrlset{2}}{C}
    \justifies
    \zsyseq{\Gamma}{\Delta_1, \Delta_2, A \rightarrow^{\elembases{S}}_{\ctrlset{1}} B}{\ctrlset{1}\cup\ctrlset{2}}{C}
    \using{\respects{\Delta_2}{\ctrlset{1}}}
  \end{prooftree}
\]

The resulting sequent calculus is given in full in Figure~\ref{bkwseqcalc}.

\begin{figure}[ht]
  \begin{mdframed}

    \[
      \begin{prooftree}
        \justifies
        \zsyseq{\Gamma}{A}{\ctrlset{}}{A}
        \using{\init}
      \end{prooftree}
      \qquad \qquad
      \begin{prooftree}
        \zsyseq{\Gamma, A}{\Delta, A}{\ctrlset{}}{C}
        \justifies
        \zsyseq{\Gamma, A}{\Delta}{\ctrlset{}}{C}
        \using{\copyrule}
      \end{prooftree}
    \]

    \[
      \begin{prooftree}
        \zsyseq{\Gamma}{\Delta_1}{\emptyset}{A} \qquad
        \zsyseq{\Gamma}{\Delta_2}{\emptyset}{B}
        \justifies
        \zsyseq{\Gamma}{\Delta_1, \Delta_2}{\emptyset}{A \otimes B}
        \using{\otimes R}
      \end{prooftree}
    \]

    \[
      \begin{prooftree}
        \zsyseq{\Gamma}{\Delta, A \otimes B}{\ctrlset{}}{C}
        \justifies
        \zsyseq{\Gamma}{\Delta, A, B}{\ctrlset{}}{C}
        \using{\otimes L}
      \end{prooftree}
      \qquad \qquad
      \begin{prooftree}
        \zsyseq{\Gamma}{\Delta, A}{\ctrlset{}}{B}
        \justifies
        \zsyseq{\Gamma}{\Delta}{\emptyset}{A \limp^{\elembases{\Delta}}_{\ctrlset{}}
          B}
        \using{\rightarrow R}
      \end{prooftree}
    \]

    \[
      \begin{prooftree}
        \zsyseq{\Gamma}{\Delta_1}{\emptyset}{A}\qquad
        \zsyseq{\Gamma}{\Delta_2, B}{\ctrlset{2}}{C}
        \qquad \respects{\Delta_2}{\ctrlset{1}}
        \justifies
        \zsyseq{\Gamma}{\Delta_1, \Delta_2, A \rightarrow^{S}_{\ctrlset{1}} B}{\ctrlset{1}\cup\ctrlset{2}}{C}
        \using{\rightarrow L}
      \end{prooftree}
    \]

  \end{mdframed}
  \caption{\label{bkwseqcalc} Annotated backward sequent calculus \zss{}.}
\end{figure}

\begin{lemma}[Identity expansion]
  The calculus \zss{}' with identity axiom allowing arbitrary formulas is
  equivalent to the calculus \zss{} with identity axiom restricted to atomic
  formulas.
\end{lemma}
\begin{proof}
  By induction on the derivations. There are as many cases as there are
  connectives to consider.

  \begin{enumerate}
  \item Case $\zsyseq{\Gamma}{A \otimes B}{\emptyset}{A \otimes B}$. Then,

    \[
      \begin{prooftree}
        \[
          \zsyseq{\Gamma}{A}{\emptyset}{A}
          \qquad
          \zsyseq{\Gamma}{B}{\emptyset}{B}
          \justifies
          \zsyseq{\Gamma}{A, B}{\emptyset}{A \otimes B}
          \using{\otimes R}
        \]
        \justifies
        \zsyseq{\Gamma}{A \otimes B}{\emptyset}{A \otimes B}
        \using{\otimes L}
      \end{prooftree}
    \]

  \item Case $\zsyseq{\Gamma}{A \rightarrow_{\ctrlset{}}^S B}{\emptyset}{A
      \rightarrow_{\ctrlset{}}^S B}$. Then, the following holds

    \[
      \begin{prooftree}
        \[
          \zsyseq{\Gamma}{A}{\emptyset}{A}\qquad
          \zsyseq{\Gamma}{B}{\emptyset}{B}
          \justifies
          \zsyseq{\Gamma}{A \rightarrow_{\ctrlset{}}^S B, A}{\ctrlset{}}{B}
        \]
        \justifies
        \zsyseq{\Gamma}{A \rightarrow_{\ctrlset{}}^S B}{\emptyset}{A
          \rightarrow_{\ctrlset{}}^S B}
      \end{prooftree}
    \]

    since $\elembases{A \rightarrow^S_{\ctrlset{}} B} = S$.
  \end{enumerate}
\end{proof}

\begin{theorem}[Cut admissibility]
  The following cut rule

  \[
    \begin{prooftree}
      \zsyseq{\Gamma}{\Delta_1}{\ctrlset{1}}{A}
      \qquad
      \zsyseq{\Gamma}{\Delta_2, A}{\ctrlset{2}}{B}
      \justifies
      \zsyseq{\Gamma}{\Delta_1, \Delta_2}{\ctrlset{1}\cup\ctrlset{2}}{B}
      \using{\forall \Delta,\respects{\Delta,\Delta_2}{\ctrlset{1}}}
    \end{prooftree}
  \]

  is admissible.
\end{theorem}
\begin{proof}
  The proof is inspired by the one given in [cmu thesis] for the full
  intuitionistic linear logic. In particular, we consider four ``classes'' of
  cuts and show admissibility for all of them. The theorem follows from the fact
  that these four classes cover all possible uses of the cut rule above.

  \begin{description}
  \item[Identity cuts] One of the premises is obtained by an application of the
    identity axiom.

    \begin{enumerate}
    \item Left case.

      \[
        \begin{prooftree}
          \[ \justifies \zsyseq{\Gamma}{A}{\emptyset}{A} \]
          \qquad
          \zsyseq{\Gamma}{\Delta_2, A}{\ctrlset{2}}{B}
          \justifies
          \zsyseq{\Gamma}{A, \Delta_2}{\ctrlset{2}}{B}
        \end{prooftree}
      \]

      Then, just take the second premise.

    \item Right case.

      \[
        \begin{prooftree}
          \zsyseq{\Gamma}{\Delta_1}{\ctrlset{1}}{A}
          \qquad
          \[ \justifies \zsyseq{\Gamma}{A}{\emptyset}{A}\]
          \justifies
          \zsyseq{\Gamma}{\Delta_1}{\ctrlset{1}}{A}
        \end{prooftree}
      \]

      Then, just take the first premise.
    \end{enumerate}
  \item[Principal cuts] The cut formula is principal in both premises. We
    distinguish the two possible cases of non-atomic formulas.

    \begin{enumerate}
    \item Case $\otimes$.


      \[
        \begin{prooftree}
          \[
            \zsyseq{\Gamma}{\Delta_1}{\emptyset}{A}
            \qquad
            \zsyseq{\Gamma}{\Delta_2}{\emptyset}{B}
            \justifies
            \zsyseq{\Gamma}{\Delta_1, \Delta_2}{\emptyset}{A \otimes B}
          \]
          \qquad
          \[
            \zsyseq{\Gamma}{\Delta_3, A, B}{\ctrlset{}}{C}
            \justifies
            \zsyseq{\Gamma}{\Delta_3, A \otimes B}{\ctrlset{}}{C}
          \]
          \justifies
          \zsyseq{\Gamma}{\Delta_1, \Delta_2}{\ctrlset{}}{C}
        \end{prooftree}
      \]

      Then, by inductive hypothesis, we have

      \[
        \begin{prooftree}
          \zsyseq{\Gamma}{\Delta_2}{\emptyset}{B}
          \qquad
          \[
            \zsyseq{\Gamma}{\Delta_1}{\emptyset}{A}
            \qquad
            \zsyseq{\Gamma}{\Delta_3, A, B}{\ctrlset{}}{C}
            \justifies
            \zsyseq{\Gamma}{\Delta_1, \Delta_3, B}{\ctrlset{}}{C}
          \]
          \justifies
          \zsyseq{\Gamma}{\Delta_1, \Delta_2}{\ctrlset{}}{C}
        \end{prooftree}
      \]

    \item Case $\rightarrow_{\ctrlset{}}^S$.

      \[
        \begin{prooftree}
          \[
            \zsyseq{\Gamma}{\Delta_1, A}{\ctrlset{1}}{B}
            \justifies
            \zsyseq{\Gamma}{\Delta_1}{\emptyset}{A \rightarrow_{\ctrlset{1}}^{\elembases{\Delta_1}} B}
          \]
          \qquad
          \[
            \zsyseq{\Gamma}{\Delta_2}{\emptyset}{A}
            \qquad
            \zsyseq{\Gamma}{\Delta_3, B}{\ctrlset{2}}{C}
            \justifies
            \zsyseq{\Gamma}{\Delta_2, \Delta_3, A
              \rightarrow_{\ctrlset{1}}^{\elembases{\Delta_1}}
              B}{\ctrlset{1}\cup\ctrlset{2}}{C}
            \using{\respects{\Delta_3}{\ctrlset{1}}}
          \]
          \justifies
          \zsyseq{\Gamma}{\Delta_1, \Delta_2, \Delta_3}{\ctrlset{1}\cup\ctrlset{2}}{C}
        \end{prooftree}
      \]

      Then, by inductive hypothesis, we have

      \[
        \begin{prooftree}
          \[
            \zsyseq{\Gamma}{\Delta_2}{\emptyset}{A}
            \qquad
            \zsyseq{\Gamma}{\Delta_1, A}{\ctrlset{1}}{B}
            \justifies
            \zsyseq{\Gamma}{\Delta_1, \Delta_2}{\ctrlset{1}}{B}
          \]
          \quad
          \zsyseq{\Gamma}{\Delta_3, B}{\ctrlset{2}}{C}
          \justifies
          \zsyseq{\Gamma}{\Delta_1, \Delta_2, \Delta_3}{\ctrlset{1}\cup\ctrlset{2}}{C}
          \using{\respects{\Delta_3}{\ctrlset{1}}}
        \end{prooftree}
      \]

    \end{enumerate}
  \item[Left-commutative cuts] The cut formula is a side formula in the left
    premise. The cut is then simply moved up to the premises, where the
    inductive hypothesis is used.

    \begin{enumerate}
    \item Case $\otimes L$.

      \[
        \begin{prooftree}
          \[
            \zsyseq{\Gamma}{\Delta_1, C, D}{\ctrlset{1}}{A}
            \justifies
            \zsyseq{\Gamma}{\Delta_1, C \otimes D}{\ctrlset{1}}{A}
            \using{\otimes L}
          \]
          \qquad
          \zsyseq{\Gamma}{\Delta_2, A}{\ctrlset{2}}{B}
          \justifies
          \zsyseq{\Gamma}{\Delta_1, \Delta_2, C \otimes D}{\ctrlset{1}\cup\ctrlset{2}}{B}
          \using{\forall \Delta, \respects{\Delta,\Delta_2}{\ctrlset{1}}}
        \end{prooftree}
      \]

      becomes

      \[
        \begin{prooftree}
          \[
            \zsyseq{\Gamma}{\Delta_1, C, D}{\ctrlset{1}}{A}
            \qquad
            \zsyseq{\Gamma}{\Delta_2, A}{\ctrlset{2}}{B}
            \justifies
            \zsyseq{\Gamma}{\Delta_1, \Delta_2, C,
              D}{\ctrlset{1}\cup\ctrlset{2}}{B}
            \using{\forall \Delta, \respects{\Delta,\Delta_2}{\ctrlset{1}}}
          \]
          \justifies
          \zsyseq{\Gamma}{\Delta_1, \Delta_2, C \otimes D}{\ctrlset{1}\cup\ctrlset{2}}{B}
          \using{\otimes L}
        \end{prooftree}
      \]

    \item Case $\copyrule$.

      \[
        \begin{prooftree}
          \[
            \zsyseq{\Gamma, C}{\Delta_1, C}{\ctrlset{1}}{A}
            \justifies
            \zsyseq{\Gamma, C}{\Delta_1}{\ctrlset{1}}{A}
          \]
          \qquad
          \zsyseq{\Gamma, C}{\Delta_2, A}{\ctrlset{2}}{B}
          \justifies
          \zsyseq{\Gamma, C}{\Delta_1, \Delta_2}{\ctrlset{1}\cup\ctrlset{2}}{B}
          \using{\forall \Delta, \respects{\Delta,\Delta_2}{\ctrlset{1}}}
        \end{prooftree}
      \]

      becomes

      \[
        \begin{prooftree}
          \[
            \zsyseq{\Gamma, C}{\Delta_1, C}{\ctrlset{1}}{A}
            \qquad
            \zsyseq{\Gamma, C}{\Delta_2, A}{\ctrlset{2}}{B}
            \justifies
            \zsyseq{\Gamma, C}{\Delta_1, C,
              \Delta_2}{\ctrlset{1}\cup\ctrlset{2}}{B}
            \using{\forall \Delta, \respects{\Delta,\Delta_2}{\ctrlset{1}}}
          \]
          \justifies
          \zsyseq{\Gamma, C}{\Delta_1, \Delta_2}{\ctrlset{1}\cup\ctrlset{2}}{B}
          \using{\copyrule}
        \end{prooftree}
      \]

    \item Case $\rightarrow L$.

      \[
        \begin{prooftree}
          \[
            \zsyseq{\Gamma}{\Delta_1}{\emptyset}{C}
            \qquad
            \zsyseq{\Gamma}{\Delta_2, D}{\ctrlset{1}}{A}
            \justifies
            \zsyseq{\Gamma}{\Delta_1, \Delta_2, C \rightarrow_{\ctrlset{}}^S D
            }{\ctrlset{} \cup \ctrlset{1}}{A}
            \using{\respects{\Delta_2}{\ctrlset{}}}
          \]
          \quad
          \zsyseq{\Gamma}{\Delta_3, A}{\ctrlset{2}}{B}
          \justifies
          \zsyseq{\Gamma}{\Delta_1, \Delta_2, \Delta_3, C
            \rightarrow_{\ctrlset{}}^S D}{\ctrlset{} \cup \ctrlset{1}\cup\ctrlset{2}}{B}
          \using{\forall \Delta, \respects{\Delta,\Delta_3}{\ctrlset{} \cup \ctrlset{1}}}
        \end{prooftree}
      \]

      Notice that, from our definition of control sets, it follows that

      \[
        \forall \Delta, \respects{\Delta,\Delta_3}{\ctrlset{} \cup \ctrlset{1}}
        \ \text{implies}\
        \forall \Delta, \respects{\Delta,\Delta_3}{\ctrlset{1}}
      \]

      Moreover, by hypothesis we have that
      $\respects{\Delta_2, \Delta_3}{\ctrlset{}}$. Therefore

      \[
        \begin{prooftree}
          \zsyseq{\Gamma}{\Delta_1}{\emptyset}{C}
          \quad
          \[
            \zsyseq{\Gamma}{\Delta_2, D}{\ctrlset{1}}{A}
            \qquad
            \zsyseq{\Gamma}{\Delta_3, A}{\ctrlset{2}}{B}
            \justifies
            \zsyseq{\Gamma}{\Delta_2, \Delta_3,
              D}{\ctrlset{1}\cup\ctrlset{2}}{B}
            \using{\forall \Delta, \respects{\Delta,\Delta_3}{\ctrlset{1}}}
          \]
          \justifies
          \zsyseq{\Gamma}{\Delta_1, \Delta_2, \Delta_3, C
            \rightarrow_{\ctrlset{}}^S D}{\ctrlset{} \cup
            \ctrlset{1}\cup\ctrlset{2}}{B}
          \using{\respects{\Delta_2, \Delta_3}{\ctrlset{}}}
        \end{prooftree}
      \]

    \end{enumerate}

  \item[Right-commutative cuts]

    \begin{enumerate}
    \item Case $\otimes L$.

      \[
        \begin{prooftree}
          \zsyseq{\Gamma}{\Delta_1}{\ctrlset{1}}{A}
          \qquad
          \[
            \zsyseq{\Gamma}{\Delta_2, C, D, A}{\ctrlset{2}}{B}
            \justifies
            \zsyseq{\Gamma}{\Delta_2, C \otimes D, A}{\ctrlset{2}}{B}
          \]
          \justifies
          \zsyseq{\Gamma}{\Delta_1, \Delta_2}{\ctrlset{1}\cup\ctrlset{2}}{B}
          \using{\forall \Delta,\respects{\Delta,\Delta_2}{\ctrlset{1}}}
        \end{prooftree}
      \]

      Then, by inductive hypothesis

      \[
        \begin{prooftree}
          \[
          \zsyseq{\Gamma}{\Delta_1}{\ctrlset{1}}{A}
          \qquad
          \zsyseq{\Gamma}{\Delta_2, C, D, A}{\ctrlset{2}}{B}
          \justifies
          \zsyseq{\Gamma}{\Delta_2, C \otimes D, A}{\ctrlset{2}}{B}
        \]
        \justifies
        \zsyseq{\Gamma}{\Delta_1, \Delta_2}{\ctrlset{1}\cup\ctrlset{2}}{B}
        \using{\forall \Delta,\respects{\Delta,\Delta_2}{\ctrlset{1}}}
      \end{prooftree}
      \]

    \end{enumerate}

  \end{description}
\end{proof}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../docs"
%%% End:
