{-# LANGUAGE GeneralizedNewtypeDeriving, DerivingStrategies, OverloadedStrings #-}

-- | Benchmarks for Zsyntax

module Main where

import Zsyntax
import Zsyntax.Labelled.Formula
import qualified Otter as O
import System.Exit (exitFailure)
import qualified Data.Set as S (fromList)
import qualified Data.MultiSet as M
import Data.List.NonEmpty (fromList)
import Zsyntax.ReactionList
import Data.Text (Text, pack)

import Criterion
import Criterion.Main (defaultMain)
import Data.String (IsString)

newtype BioLabel = BioLabel Text deriving newtype (Eq, Ord, Show, IsString)

main :: IO ()
main =
  defaultMain
    [ bgroup "proof search test"
      [ bench "search" $ whnf checkSequent goal2
      ]
    ]

-- boundedSearch :: Sequent a -> Extraction (Decora)
-- boundedSearch = O.extractResults 2000 . fst . search . toLabelledGoal

checkSequent :: Ord a => Sequent a -> Bool -- IO ()
checkSequent g =
  case otterResult (search g 5000) of -- (toLabelledGoal g)) of
    Right _ -> True -- putStrLn "test passed."
    Left _  -> False -- putStrLn "test failed." >> exitFailure

ax :: Ord a => [a] -> [a] -> [a] -> Axiom (BioFormula a)
ax xs ys rl =
  axiom (fromList $ fmap BioAtom xs)
        (justCS $ fromCSCtxts [CSC SupersetClosed
                                (M.fromList (fmap BioAtom rl))])
        (fromList $ fmap BioAtom ys)

type Atom = BioFormula String

goal :: Sequent Atom
goal = SQ (S.fromList axioms) (M.fromList from) to
  where
    axioms :: [Axiom Atom]
    axioms =
      [ ax ["ICL"] ["MUS81"] mempty
      , ax ["MUS81", "FANCD21"] ["FAN1"] mempty
      , ax ["FANCM", "ATR"] ["FAcore"] ["CHKREC"]
      , ax ["FANCM", "ATM"] ["FAcore"] ["CHKREC"]
      , ax ["FAcore", "ATM"] ["FANCD21"] ["USP1"]
      , ax ["FAcore", "ATR"] ["FANCD21"] ["USP1"]
      , ax ["FAcore", "H2AX", "DSB"] ["FANCD21"] ["USP1"]
      , ax ["ICL"] ["FANCM"] ["CHKREC"]
      , ax ["FAN1"] ["DSB"] ["HRR", "NHEJ"]
      , ax ["XPF"] ["DBS"] ["HRR", "NHEJ"]
      , ax ["MUS81", "FAN1"] ["ADD"] ["PCNATLS"]
      , ax ["ATM"] ["ATM", "ATM"] mempty
      , ax ["ICL"] ["ICL", "ICL"] mempty
      ]
    from :: [Formula Atom]
    from = [atom (BioAtom "ICL"), atom (BioAtom "ATM")]
    to :: Formula Atom
    to = conj (atom (BioAtom "DSB")) (atom (BioAtom "ADD"))

goal2 :: Sequent (BioFormula BioLabel)
goal2 = SQ (S.fromList axs) (M.fromList start) (foldr1 conj end)
  where
    start = map atom $
      [ BioInter (BioInter (BioInter (BioAtom "RNC") (BioInter (BioAtom "UYN") (BioAtom "SPC"))) (BioInter (BioInter (BioAtom "ETH") (BioAtom "CYO")) (BioInter (BioAtom "SAJ") (BioAtom "UII")))) (BioInter (BioInter (BioAtom "TJB") (BioAtom "GMQ")) (BioAtom "USU"))
      , BioInter (BioAtom "GUU") (BioInter (BioAtom "SAG") (BioAtom "WAJ"))
      , BioAtom "YSZ"
      , BioInter (BioInter (BioAtom "ZME") (BioInter (BioAtom "JOI") (BioAtom "YSG"))) (BioInter (BioInter (BioAtom "TSV") (BioAtom "VYK")) (BioAtom "DMA"))
      , BioAtom "DHD"
      , BioInter (BioInter (BioAtom "YKX") (BioAtom "VRF")) (BioAtom "LKT")
      , BioInter (BioInter (BioAtom "HXG") (BioInter (BioAtom "SPI") (BioAtom "VHK"))) (BioInter (BioAtom "GIL") (BioAtom "GPE"))
      , BioAtom "ACJ"]

    axs :: [Axiom (BioFormula BioLabel)]
    axs =
      [ Axiom {unSA = LAx (BAtom (BioInter (BioInter (BioInter (BioAtom "RNC") (BioInter (BioAtom "UYN") (BioAtom "SPC"))) (BioInter (BioInter (BioAtom "ETH") (BioAtom "CYO")) (BioInter (BioAtom "SAJ") (BioAtom "UII")))) (BioInter (BioInter (BioAtom "TJB") (BioAtom "GMQ")) (BioAtom "USU")))) (RL {unRL = []}) (BAtom (BioInter (BioInter (BioAtom "RFU") (BioAtom "DMK")) (BioInter (BioAtom "NGB") (BioInter (BioAtom "YOO") (BioAtom "LFD"))))) ()}
      , Axiom {unSA = LAx (BAtom (BioInter (BioAtom "GUU") (BioInter (BioAtom "SAG") (BioAtom "WAJ")))) (RL {unRL = []}) (BAtom (BioInter (BioInter (BioAtom "CRX") (BioAtom "YJT")) (BioInter (BioAtom "EIE") (BioInter (BioAtom "LLL") (BioAtom "NPH"))))) ()}
      , Axiom {unSA = LAx (BAtom (BioAtom "YSZ")) (RL {unRL = []}) (BAtom (BioInter (BioAtom "WJJ") (BioAtom "OHS"))) ()}
      , Axiom {unSA = LAx (BAtom (BioInter (BioInter (BioAtom "ZME") (BioInter (BioAtom "JOI") (BioAtom "YSG"))) (BioInter (BioInter (BioAtom "TSV") (BioAtom "VYK")) (BioAtom "DMA")))) (RL {unRL = []}) (BAtom (BioInter (BioAtom "DOA") (BioAtom "EQT"))) ()}
      , Axiom {unSA = LAx (BAtom (BioAtom "DHD")) (RL {unRL = []}) (BAtom (BioAtom "BHB")) ()}
      , Axiom {unSA = LAx (BAtom (BioInter (BioInter (BioAtom "YKX") (BioAtom "VRF")) (BioAtom "LKT"))) (RL {unRL = []}) (BAtom (BioInter (BioAtom "QUH") (BioInter (BioAtom "VWA") (BioAtom "JZO")))) ()}
      , Axiom {unSA = LAx (BAtom (BioInter (BioInter (BioAtom "HXG") (BioInter (BioAtom "SPI") (BioAtom "VHK"))) (BioInter (BioAtom "GIL") (BioAtom "GPE")))) (RL {unRL = []}) (BAtom (BioInter (BioInter (BioInter (BioInter (BioAtom "OPS") (BioAtom "LBJ")) (BioAtom "RAO")) (BioInter (BioInter (BioAtom "ZEK") (BioAtom "MZP")) (BioInter (BioAtom "LUK") (BioAtom "FRW")))) (BioInter (BioAtom "UIA") (BioAtom "MTS")))) ()},Axiom {unSA = LAx (BAtom (BioAtom "ACJ")) (RL {unRL = []}) (BAtom (BioInter (BioAtom "GFM") (BioAtom "AHS"))) ()},Axiom {unSA = LAx (BAtom (BioInter (BioInter (BioAtom "RFU") (BioAtom "DMK")) (BioInter (BioAtom "NGB") (BioInter (BioAtom "YOO") (BioAtom "LFD"))))) (RL {unRL = []}) (BAtom (BioInter (BioAtom "QCV") (BioAtom "LOU"))) ()},Axiom {unSA = LAx (BAtom (BioInter (BioInter (BioAtom "CRX") (BioAtom "YJT")) (BioInter (BioAtom "EIE") (BioInter (BioAtom "LLL") (BioAtom "NPH"))))) (RL {unRL = []}) (BAtom (BioInter (BioAtom "XJW") (BioAtom "WUJ"))) ()},Axiom {unSA = LAx (BAtom (BioInter (BioAtom "WJJ") (BioAtom "OHS"))) (RL {unRL = []}) (BAtom (BioInter (BioInter (BioAtom "EMM") (BioInter (BioAtom "OKY") (BioAtom "IPY"))) (BioInter (BioAtom "PQF") (BioAtom "PTC")))) ()},Axiom {unSA = LAx (BAtom (BioInter (BioAtom "DOA") (BioAtom "EQT"))) (RL {unRL = []}) (BAtom (BioAtom "UXG")) ()},Axiom {unSA = LAx (BAtom (BioAtom "BHB")) (RL {unRL = []}) (BAtom (BioInter (BioAtom "ABS") (BioInter (BioAtom "KAU") (BioAtom "HNS")))) ()},Axiom {unSA = LAx (BAtom (BioInter (BioAtom "QUH") (BioInter (BioAtom "VWA") (BioAtom "JZO")))) (RL {unRL = []}) (BAtom (BioAtom "FBH")) ()},Axiom {unSA = LAx (BAtom (BioInter (BioInter (BioInter (BioInter (BioAtom "OPS") (BioAtom "LBJ")) (BioAtom "RAO")) (BioInter (BioInter (BioAtom "ZEK") (BioAtom "MZP")) (BioInter (BioAtom "LUK") (BioAtom "FRW")))) (BioInter (BioAtom "UIA") (BioAtom "MTS")))) (RL {unRL = []}) (BAtom (BioInter (BioInter (BioAtom "WHQ") (BioAtom "NOL")) (BioAtom "JBV"))) ()},Axiom {unSA = LAx (BAtom (BioInter (BioAtom "GFM") (BioAtom "AHS"))) (RL {unRL = []}) (BAtom (BioInter (BioInter (BioInter (BioAtom "WIA") (BioAtom "JNZ")) (BioInter (BioAtom "QNH") (BioAtom "XQT"))) (BioInter (BioAtom "BUY") (BioAtom "WVN")))) ()},Axiom {unSA = LAx (BAtom (BioInter (BioAtom "QCV") (BioAtom "LOU"))) (RL {unRL = []}) (BAtom (BioInter (BioInter (BioAtom "YLT") (BioInter (BioInter (BioAtom "VRH") (BioAtom "CWQ")) (BioAtom "PEZ"))) (BioInter (BioInter (BioAtom "NOC") (BioAtom "PKH")) (BioAtom "JNX")))) ()},Axiom {unSA = LAx (BAtom (BioInter (BioAtom "XJW") (BioAtom "WUJ"))) (RL {unRL = []}) (BAtom (BioInter (BioInter (BioAtom "WHD") (BioAtom "CKE")) (BioAtom "WVB"))) ()},Axiom {unSA = LAx (BAtom (BioInter (BioInter (BioAtom "EMM") (BioInter (BioAtom "OKY") (BioAtom "IPY"))) (BioInter (BioAtom "PQF") (BioAtom "PTC")))) (RL {unRL = []}) (BAtom (BioInter (BioAtom "RUN") (BioInter (BioAtom "YIJ") (BioInter (BioAtom "WDJ") (BioAtom "BXG"))))) ()},Axiom {unSA = LAx (BAtom (BioAtom "UXG")) (RL {unRL = []}) (BAtom (BioInter (BioInter (BioAtom "YWI") (BioAtom "QYO")) (BioInter (BioInter (BioAtom "XQA") (BioAtom "AMD")) (BioInter (BioInter (BioAtom "GPG") (BioAtom "NEG")) (BioAtom "RVF"))))) ()},Axiom {unSA = LAx (BAtom (BioInter (BioAtom "ABS") (BioInter (BioAtom "KAU") (BioAtom "HNS")))) (RL {unRL = []}) (BAtom (BioInter (BioInter (BioAtom "LRL") (BioAtom "FVC")) (BioInter (BioInter (BioAtom "ANQ") (BioAtom "PFT")) (BioAtom "WAZ")))) ()},Axiom {unSA = LAx (BAtom (BioAtom "FBH")) (RL {unRL = []}) (BAtom (BioAtom "FCC")) ()},Axiom {unSA = LAx (BAtom (BioInter (BioInter (BioAtom "WHQ") (BioAtom "NOL")) (BioAtom "JBV"))) (RL {unRL = []}) (BAtom (BioInter (BioInter (BioAtom "AWY") (BioAtom "SXM")) (BioInter (BioAtom "SKC") (BioAtom "EXS")))) ()},Axiom {unSA = LAx (BAtom (BioInter (BioInter (BioInter (BioAtom "WIA") (BioAtom "JNZ")) (BioInter (BioAtom "QNH") (BioAtom "XQT"))) (BioInter (BioAtom "BUY") (BioAtom "WVN")))) (RL {unRL = []}) (BAtom (BioAtom "VYF")) ()},Axiom {unSA = LAx (BAtom (BioInter (BioInter (BioAtom "YLT") (BioInter (BioInter (BioAtom "VRH") (BioAtom "CWQ")) (BioAtom "PEZ"))) (BioInter (BioInter (BioAtom "NOC") (BioAtom "PKH")) (BioAtom "JNX")))) (RL {unRL = []}) (BAtom (BioInter (BioInter (BioAtom "URC") (BioAtom "YOF")) (BioInter (BioAtom "SOT") (BioAtom "JYZ")))) ()},Axiom {unSA = LAx (BAtom (BioInter (BioInter (BioAtom "WHD") (BioAtom "CKE")) (BioAtom "WVB"))) (RL {unRL = []}) (BAtom (BioInter (BioInter (BioAtom "WOF") (BioAtom "TSW")) (BioInter (BioInter (BioAtom "BWX") (BioAtom "TWH")) (BioInter (BioAtom "PZY") (BioInter (BioAtom "QWI") (BioAtom "FWR")))))) ()},Axiom {unSA = LAx (BAtom (BioInter (BioAtom "RUN") (BioInter (BioAtom "YIJ") (BioInter (BioAtom "WDJ") (BioAtom "BXG"))))) (RL {unRL = []}) (BAtom (BioInter (BioInter (BioInter (BioAtom "TDD") (BioAtom "USF")) (BioInter (BioInter (BioAtom "VZK") (BioAtom "GGU")) (BioAtom "XNK"))) (BioAtom "ADA"))) ()},Axiom {unSA = LAx (BAtom (BioInter (BioInter (BioAtom "YWI") (BioAtom "QYO")) (BioInter (BioInter (BioAtom "XQA") (BioAtom "AMD")) (BioInter (BioInter (BioAtom "GPG") (BioAtom "NEG")) (BioAtom "RVF"))))) (RL {unRL = []}) (BAtom (BioInter (BioAtom "YYG") (BioAtom "VQI"))) ()},Axiom {unSA = LAx (BAtom (BioInter (BioInter (BioAtom "LRL") (BioAtom "FVC")) (BioInter (BioInter (BioAtom "ANQ") (BioAtom "PFT")) (BioAtom "WAZ")))) (RL {unRL = []}) (BAtom (BioAtom "XOM")) ()},Axiom {unSA = LAx (BAtom (BioAtom "FCC")) (RL {unRL = []}) (BAtom (BioInter (BioInter (BioAtom "NDR") (BioAtom "NNY")) (BioInter (BioAtom "OMO") (BioAtom "IVH")))) ()},Axiom {unSA = LAx (BAtom (BioInter (BioInter (BioAtom "AWY") (BioAtom "SXM")) (BioInter (BioAtom "SKC") (BioAtom "EXS")))) (RL {unRL = []}) (BAtom (BioInter (BioInter (BioAtom "SWW") (BioInter (BioAtom "TLK") (BioInter (BioAtom "EYV") (BioAtom "XSF")))) (BioAtom "NNX"))) ()},Axiom {unSA = LAx (BAtom (BioAtom "VYF")) (RL {unRL = []}) (BAtom (BioInter (BioAtom "MEZ") (BioAtom "QDP"))) ()},Axiom {unSA = LAx (BAtom (BioInter (BioInter (BioAtom "URC") (BioAtom "YOF")) (BioInter (BioAtom "SOT") (BioAtom "JYZ")))) (RL {unRL = []}) (BAtom (BioInter (BioAtom "KWD") (BioAtom "HSQ"))) ()},Axiom {unSA = LAx (BAtom (BioInter (BioInter (BioAtom "WOF") (BioAtom "TSW")) (BioInter (BioInter (BioAtom "BWX") (BioAtom "TWH")) (BioInter (BioAtom "PZY") (BioInter (BioAtom "QWI") (BioAtom "FWR")))))) (RL {unRL = []}) (BAtom (BioInter (BioInter (BioAtom "XPC") (BioAtom "LBM")) (BioInter (BioInter (BioAtom "DBR") (BioAtom "MIH")) (BioInter (BioAtom "FDK") (BioAtom "NYY"))))) ()},Axiom {unSA = LAx (BAtom (BioInter (BioInter (BioInter (BioAtom "TDD") (BioAtom "USF")) (BioInter (BioInter (BioAtom "VZK") (BioAtom "GGU")) (BioAtom "XNK"))) (BioAtom "ADA"))) (RL {unRL = []}) (BAtom (BioInter (BioAtom "HJJ") (BioAtom "XKW"))) ()},Axiom {unSA = LAx (BAtom (BioInter (BioAtom "YYG") (BioAtom "VQI"))) (RL {unRL = []}) (BAtom (BioAtom "EJG")) ()},Axiom {unSA = LAx (BAtom (BioAtom "XOM")) (RL {unRL = []}) (BAtom (BioInter (BioInter (BioAtom "BXV") (BioAtom "SSY")) (BioInter (BioInter (BioAtom "PGX") (BioAtom "GCP")) (BioInter (BioAtom "TPH") (BioAtom "FZD"))))) ()},Axiom {unSA = LAx (BAtom (BioInter (BioInter (BioAtom "NDR") (BioAtom "NNY")) (BioInter (BioAtom "OMO") (BioAtom "IVH")))) (RL {unRL = []}) (BAtom (BioInter (BioInter (BioInter (BioAtom "HUW") (BioAtom "BLP")) (BioInter (BioAtom "AYC") (BioAtom "KKA"))) (BioInter (BioAtom "MYN") (BioAtom "XZR")))) ()},Axiom {unSA = LAx (BAtom (BioInter (BioInter (BioAtom "SWW") (BioInter (BioAtom "TLK") (BioInter (BioAtom "EYV") (BioAtom "XSF")))) (BioAtom "NNX"))) (RL {unRL = []}) (BAtom (BioInter (BioInter (BioAtom "OCZ") (BioAtom "HGV")) (BioInter (BioInter (BioAtom "ISL") (BioAtom "ELI")) (BioInter (BioAtom "VZC") (BioAtom "MSN"))))) ()},Axiom {unSA = LAx (BAtom (BioInter (BioAtom "MEZ") (BioAtom "QDP"))) (RL {unRL = []}) (BAtom (BioAtom "ZUS")) ()},Axiom {unSA = LAx (BAtom (BioInter (BioAtom "KWD") (BioAtom "HSQ"))) (RL {unRL = []}) (BAtom (BioAtom "XMW")) ()},Axiom {unSA = LAx (BAtom (BioInter (BioInter (BioAtom "XPC") (BioAtom "LBM")) (BioInter (BioInter (BioAtom "DBR") (BioAtom "MIH")) (BioInter (BioAtom "FDK") (BioAtom "NYY"))))) (RL {unRL = []}) (BAtom (BioAtom "BTA")) ()},Axiom {unSA = LAx (BAtom (BioInter (BioAtom "HJJ") (BioAtom "XKW"))) (RL {unRL = []}) (BAtom (BioInter (BioAtom "ANB") (BioInter (BioAtom "QFE") (BioAtom "MRQ")))) ()},Axiom {unSA = LAx (BAtom (BioAtom "EJG")) (RL {unRL = []}) (BAtom (BioInter (BioInter (BioInter (BioAtom "EOJ") (BioInter (BioAtom "FPG") (BioAtom "JYY"))) (BioAtom "MFZ")) (BioAtom "OJX"))) ()},Axiom {unSA = LAx (BAtom (BioInter (BioInter (BioAtom "BXV") (BioAtom "SSY")) (BioInter (BioInter (BioAtom "PGX") (BioAtom "GCP")) (BioInter (BioAtom "TPH") (BioAtom "FZD"))))) (RL {unRL = []}) (BAtom (BioInter (BioInter (BioAtom "QOW") (BioAtom "ASH")) (BioAtom "FBJ"))) ()},Axiom {unSA = LAx (BAtom (BioInter (BioInter (BioInter (BioAtom "HUW") (BioAtom "BLP")) (BioInter (BioAtom "AYC") (BioAtom "KKA"))) (BioInter (BioAtom "MYN") (BioAtom "XZR")))) (RL {unRL = []}) (BAtom (BioInter (BioAtom "WSG") (BioInter (BioInter (BioAtom "ZCN") (BioAtom "PTZ")) (BioAtom "EMX")))) ()},Axiom {unSA = LAx (BAtom (BioInter (BioInter (BioAtom "OCZ") (BioAtom "HGV")) (BioInter (BioInter (BioAtom "ISL") (BioAtom "ELI")) (BioInter (BioAtom "VZC") (BioAtom "MSN"))))) (RL {unRL = []}) (BAtom (BioInter (BioInter (BioAtom "DNR") (BioInter (BioAtom "XKC") (BioAtom "WRR"))) (BioAtom "SDN"))) ()},Axiom {unSA = LAx (BAtom (BioAtom "ZUS")) (RL {unRL = []}) (BAtom (BioInter (BioInter (BioInter (BioAtom "ICK") (BioAtom "NKH")) (BioAtom "BFQ")) (BioAtom "MBR"))) ()},Axiom {unSA = LAx (BAtom (BioAtom "XMW")) (RL {unRL = []}) (BAtom (BioInter (BioInter (BioAtom "SIY") (BioAtom "ESC")) (BioInter (BioInter (BioAtom "FOO") (BioAtom "NWS")) (BioAtom "WJY")))) ()},Axiom {unSA = LAx (BAtom (BioAtom "BTA")) (RL {unRL = []}) (BAtom (BioInter (BioInter (BioInter (BioAtom "BCP") (BioAtom "LVM")) (BioAtom "ITI")) (BioAtom "TGZ"))) ()},Axiom {unSA = LAx (BAtom (BioInter (BioAtom "ANB") (BioInter (BioAtom "QFE") (BioAtom "MRQ")))) (RL {unRL = []}) (BAtom (BioInter (BioAtom "ZVX") (BioInter (BioInter (BioInter (BioAtom "AGJ") (BioAtom "XSS")) (BioInter (BioAtom "KKR") (BioAtom "JYX"))) (BioInter (BioAtom "KBD") (BioAtom "ZOF"))))) ()},Axiom {unSA = LAx (BAtom (BioInter (BioInter (BioInter (BioAtom "EOJ") (BioInter (BioAtom "FPG") (BioAtom "JYY"))) (BioAtom "MFZ")) (BioAtom "OJX"))) (RL {unRL = []}) (BAtom (BioAtom "BYP")) ()},Axiom {unSA = LAx (BAtom (BioInter (BioInter (BioAtom "QOW") (BioAtom "ASH")) (BioAtom "FBJ"))) (RL {unRL = []}) (BAtom (BioInter (BioInter (BioAtom "HKS") (BioAtom "ZBW")) (BioInter (BioAtom "HAC") (BioAtom "CWC")))) ()},Axiom {unSA = LAx (BAtom (BioInter (BioAtom "WSG") (BioInter (BioInter (BioAtom "ZCN") (BioAtom "PTZ")) (BioAtom "EMX")))) (RL {unRL = []}) (BAtom (BioInter (BioAtom "GCO") (BioInter (BioAtom "XZY") (BioAtom "SMW")))) ()},Axiom {unSA = LAx (BAtom (BioInter (BioInter (BioAtom "DNR") (BioInter (BioAtom "XKC") (BioAtom "WRR"))) (BioAtom "SDN"))) (RL {unRL = []}) (BAtom (BioInter (BioInter (BioAtom "KKY") (BioAtom "DVG")) (BioInter (BioAtom "MIE") (BioAtom "FAU")))) ()},Axiom {unSA = LAx (BAtom (BioInter (BioInter (BioInter (BioAtom "ICK") (BioAtom "NKH")) (BioAtom "BFQ")) (BioAtom "MBR"))) (RL {unRL = []}) (BAtom (BioInter (BioInter (BioInter (BioAtom "WWS") (BioAtom "LTR")) (BioInter (BioAtom "JCQ") (BioAtom "CKE"))) (BioAtom "JIV"))) ()},Axiom {unSA = LAx (BAtom (BioInter (BioInter (BioAtom "SIY") (BioAtom "ESC")) (BioInter (BioInter (BioAtom "FOO") (BioAtom "NWS")) (BioAtom "WJY")))) (RL {unRL = []}) (BAtom (BioInter (BioInter (BioInter (BioInter (BioAtom "YNO") (BioAtom "ZOF")) (BioAtom "HXI")) (BioInter (BioInter (BioInter (BioAtom "KBE") (BioAtom "GJU")) (BioInter (BioAtom "CEE") (BioAtom "VOQ"))) (BioInter (BioAtom "CYY") (BioInter (BioAtom "MAU") (BioAtom "DUI"))))) (BioInter (BioInter (BioInter (BioInter (BioAtom "OYC") (BioAtom "XIO")) (BioInter (BioInter (BioAtom "CTN") (BioInter (BioInter (BioInter (BioInter (BioAtom "JNJ") (BioAtom "TPD")) (BioInter (BioAtom "HHY") (BioAtom "IVT"))) (BioInter (BioInter (BioInter (BioAtom "IYE") (BioAtom "NKW")) (BioInter (BioAtom "WRU") (BioAtom "THM"))) (BioInter (BioAtom "SVI") (BioAtom "YXV")))) (BioInter (BioAtom "AUF") (BioInter (BioAtom "MIA") (BioAtom "CEP"))))) (BioInter (BioAtom "MGT") (BioInter (BioAtom "ZKP") (BioAtom "DNC"))))) (BioInter (BioInter (BioAtom "RBZ") (BioAtom "AFT")) (BioAtom "NJG"))) (BioInter (BioInter (BioInter (BioInter (BioAtom "RFP") (BioAtom "LMV")) (BioInter (BioInter (BioAtom "DZK") (BioInter (BioAtom "SBP") (BioAtom "WOD"))) (BioAtom "YGU"))) (BioAtom "FDB")) (BioInter (BioAtom "OEM") (BioInter (BioInter (BioInter (BioInter (BioInter (BioAtom "JKP") (BioAtom "NCW")) (BioInter (BioAtom "ZUT") (BioAtom "LFV"))) (BioInter (BioAtom "BAW") (BioInter (BioAtom "QAF") (BioAtom "ULZ")))) (BioInter (BioAtom "BPX") (BioAtom "VJP"))) (BioInter (BioAtom "EYP") (BioInter (BioAtom "DHB") (BioInter (BioAtom "UXD") (BioInter (BioAtom "UZQ") (BioInter (BioAtom "UVA") (BioAtom "IGF")))))))))))) ()},Axiom {unSA = LAx (BAtom (BioInter (BioInter (BioInter (BioAtom "BCP") (BioAtom "LVM")) (BioAtom "ITI")) (BioAtom "TGZ"))) (RL {unRL = []}) (BAtom (BioInter (BioAtom "HWZ") (BioAtom "NOV"))) ()},Axiom {unSA = LAx (BAtom (BioInter (BioAtom "ZVX") (BioInter (BioInter (BioInter (BioAtom "AGJ") (BioAtom "XSS")) (BioInter (BioAtom "KKR") (BioAtom "JYX"))) (BioInter (BioAtom "KBD") (BioAtom "ZOF"))))) (RL {unRL = []}) (BAtom (BioInter (BioAtom "ALU") (BioInter (BioInter (BioInter (BioInter (BioAtom "IOW") (BioAtom "DYJ")) (BioInter (BioAtom "TGT") (BioAtom "QMC"))) (BioInter (BioAtom "HZO") (BioAtom "BBW"))) (BioInter (BioAtom "KYZ") (BioAtom "GGJ"))))) ()},Axiom {unSA = LAx (BAtom (BioAtom "BYP")) (RL {unRL = []}) (BAtom (BioAtom "UHG")) ()},Axiom {unSA = LAx (BAtom (BioInter (BioInter (BioAtom "HKS") (BioAtom "ZBW")) (BioInter (BioAtom "HAC") (BioAtom "CWC")))) (RL {unRL = []}) (BAtom (BioInter (BioAtom "NBY") (BioAtom "TIU"))) ()},Axiom {unSA = LAx (BAtom (BioInter (BioAtom "GCO") (BioInter (BioAtom "XZY") (BioAtom "SMW")))) (RL {unRL = []}) (BAtom (BioInter (BioAtom "PSX") (BioInter (BioAtom "HVS") (BioAtom "DKO")))) ()},Axiom {unSA = LAx (BAtom (BioInter (BioInter (BioAtom "KKY") (BioAtom "DVG")) (BioInter (BioAtom "MIE") (BioAtom "FAU")))) (RL {unRL = []}) (BAtom (BioInter (BioInter (BioInter (BioAtom "URK") (BioAtom "NQX")) (BioInter (BioAtom "OIL") (BioInter (BioAtom "DPL") (BioAtom "JJV")))) (BioInter (BioInter (BioInter (BioInter (BioInter (BioAtom "SQD") (BioAtom "XUT")) (BioInter (BioInter (BioAtom "TMM") (BioAtom "VJW")) (BioInter (BioAtom "VER") (BioAtom "QGX")))) (BioInter (BioInter (BioAtom "RBM") (BioAtom "MDN")) (BioInter (BioInter (BioAtom "TMH") (BioAtom "NEL")) (BioAtom "EKK")))) (BioInter (BioAtom "GML") (BioInter (BioAtom "EWB") (BioInter (BioInter (BioAtom "QRE") (BioAtom "PAG")) (BioInter (BioAtom "JOO") (BioAtom "SHT")))))) (BioInter (BioInter (BioAtom "JOB") (BioAtom "EOW")) (BioInter (BioAtom "IJN") (BioAtom "AZB")))))) ()},Axiom {unSA = LAx (BAtom (BioInter (BioInter (BioInter (BioAtom "WWS") (BioAtom "LTR")) (BioInter (BioAtom "JCQ") (BioAtom "CKE"))) (BioAtom "JIV"))) (RL {unRL = []}) (BAtom (BioInter (BioInter (BioAtom "PXZ") (BioAtom "SUX")) (BioAtom "IXS"))) ()}]

    end = map atom $
      [ BioInter (BioInter (BioInter (BioInter (BioAtom "YNO") (BioAtom "ZOF")) (BioAtom "HXI")) (BioInter (BioInter (BioInter (BioAtom "KBE") (BioAtom "GJU")) (BioInter (BioAtom "CEE") (BioAtom "VOQ"))) (BioInter (BioAtom "CYY") (BioInter (BioAtom "MAU") (BioAtom "DUI"))))) (BioInter (BioInter (BioInter (BioInter (BioAtom "OYC") (BioAtom "XIO")) (BioInter (BioInter (BioAtom "CTN") (BioInter (BioInter (BioInter (BioInter (BioAtom "JNJ") (BioAtom "TPD")) (BioInter (BioAtom "HHY") (BioAtom "IVT"))) (BioInter (BioInter (BioInter (BioAtom "IYE") (BioAtom "NKW")) (BioInter (BioAtom "WRU") (BioAtom "THM"))) (BioInter (BioAtom "SVI") (BioAtom "YXV")))) (BioInter (BioAtom "AUF") (BioInter (BioAtom "MIA") (BioAtom "CEP"))))) (BioInter (BioAtom "MGT") (BioInter (BioAtom "ZKP") (BioAtom "DNC"))))) (BioInter (BioInter (BioAtom "RBZ") (BioAtom "AFT")) (BioAtom "NJG"))) (BioInter (BioInter (BioInter (BioInter (BioAtom "RFP") (BioAtom "LMV")) (BioInter (BioInter (BioAtom "DZK") (BioInter (BioAtom "SBP") (BioAtom "WOD"))) (BioAtom "YGU"))) (BioAtom "FDB")) (BioInter (BioAtom "OEM") (BioInter (BioInter (BioInter (BioInter (BioInter (BioAtom "JKP") (BioAtom "NCW")) (BioInter (BioAtom "ZUT") (BioAtom "LFV"))) (BioInter (BioAtom "BAW") (BioInter (BioAtom "QAF") (BioAtom "ULZ")))) (BioInter (BioAtom "BPX") (BioAtom "VJP"))) (BioInter (BioAtom "EYP") (BioInter (BioAtom "DHB") (BioInter (BioAtom "UXD") (BioInter (BioAtom "UZQ") (BioInter (BioAtom "UVA") (BioAtom "IGF"))))))))))
      , BioInter (BioAtom "HWZ") (BioAtom "NOV")
      , BioInter (BioAtom "ALU") (BioInter (BioInter (BioInter (BioInter (BioAtom "IOW") (BioAtom "DYJ")) (BioInter (BioAtom "TGT") (BioAtom "QMC"))) (BioInter (BioAtom "HZO") (BioAtom "BBW"))) (BioInter (BioAtom "KYZ") (BioAtom "GGJ")))
      , BioAtom "UHG"
      , BioInter (BioAtom "NBY") (BioAtom "TIU")
      , BioInter (BioAtom "PSX") (BioInter (BioAtom "HVS") (BioAtom "DKO"))
      , BioInter (BioInter (BioInter (BioAtom "URK") (BioAtom "NQX")) (BioInter (BioAtom "OIL") (BioInter (BioAtom "DPL") (BioAtom "JJV")))) (BioInter (BioInter (BioInter (BioInter (BioInter (BioAtom "SQD") (BioAtom "XUT")) (BioInter (BioInter (BioAtom "TMM") (BioAtom "VJW")) (BioInter (BioAtom "VER") (BioAtom "QGX")))) (BioInter (BioInter (BioAtom "RBM") (BioAtom "MDN")) (BioInter (BioInter (BioAtom "TMH") (BioAtom "NEL")) (BioAtom "EKK")))) (BioInter (BioAtom "GML") (BioInter (BioAtom "EWB") (BioInter (BioInter (BioAtom "QRE") (BioAtom "PAG")) (BioInter (BioAtom "JOO") (BioAtom "SHT")))))) (BioInter (BioInter (BioAtom "JOB") (BioAtom "EOW")) (BioInter (BioAtom "IJN") (BioAtom "AZB"))))
      , BioInter (BioInter (BioAtom "PXZ") (BioAtom "SUX")) (BioAtom "IXS")]
